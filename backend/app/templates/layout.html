<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Heimdall{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}


  {% if not no_sidebar %}
    <div class="layout">
      <aside class="sidebar" id="sidebar">
        <div class="logo">
          <span class="icon">ğŸ‘</span>
          <span class="label">Heimdall</span>
        </div>
        <ul class="nav">
          <button id="collapseToggle" class="collapse-btn" title="Collapse Sidebar">â‰¡</button>
          <li><a href="/dashboard/"><span class="icon">ğŸ“º</span><span class="label">Live Monitoring</span></a></li>
          <li><a href="/inmates/"><span class="icon">ğŸ§‘â€âš–ï¸</span><span class="label">Inmate Profiles</span></a></li>
          <li><a href="/cameras/"><span class="icon">ğŸ“·</span><span class="label">Camera Feeds</span></a></li>
          <li><a href="/alerts/"><span class="icon">ğŸš¨</span><span class="label">Alerts & Logs</span></a></li>
          <li><a href="/dashboard/analytics"><span class="icon">ğŸ“Š</span><span class="label">Analytics</span></a></li>
          <li><a href="/settings/"><span class="icon">âš™ï¸</span><span class="label">Settings</span></a></li>
          <li><a href="/auth/logout"><span class="icon">ğŸšª</span><span class="label">Logout</span></a></li>
          <li><a href="{{ url_for('recognition.live_recognition') }}"><span class="icon">ğŸ¥</span><span class="label">Live Recognition</span></a></li>
          <li><a href="{{ url_for('recognition.upload_recognition') }}"><span class="icon">ğŸ“·</span><span class="label">Upload Recognition</span></a></li>
          <li><a href="/dashboard/monitor"><span class="icon">ğŸ¥</span><span class="label">Multi-Camera Monitor</span></a></li>
        {% if current_user.is_authenticated and current_user.is_admin %}
          <li><a href="{{ url_for('admin_users.list_users') }}"><span class="icon">ğŸ‘¥</span><span class="label">Manage Users</span></a></li>
        {% endif %}
        </ul>
        
      </aside>
      

      <main class="main-content">
        <div class="topbar">
          <div class="profile-dropdown">
            <img src="{{ url_for('static', filename='admin_avatar.png') }}" class="avatar" alt="Admin">
            <div class="dropdown-content">
              <p>Signed in as <strong>{{ current_user.username }}</strong></p>
              <a href="/auth/logout">Logout</a>
            </div>
          </div>
        </div>
  {% else %}
      <main class="main-content no-sidebar">
  {% endif %}

        {% block content %}{% endblock %}
      </main>
    </div>

    <script>
      document.getElementById('collapseToggle')?.addEventListener('click', () => {
        document.getElementById('sidebar').classList.toggle('collapsed');
      });
    </script>
    
</body>
</html>
